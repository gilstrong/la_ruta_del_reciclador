document.getElementById('formRegistro').addEventListener('submit', async function (e) {
  e.preventDefault();

  const nombre = document.getElementById('nombre').value.trim().toLowerCase();

  try {
    const respuesta = await fetch('https://resourceful-enchantment-production.up.railway.app/api/registrar-usuario', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ nombre }), // ← Coma importante aquí
    }); // ← Este paréntesis cierra el fetch()

    const data = await respuesta.json();

    if (respuesta.ok) {
      window.location.href = `/mapa?nombre=${encodeURIComponent(nombre)}`; // ← Paréntesis corregido
    } else {
      document.getElementById('mensajeError').textContent = data.error || 'Error al registrar.';
    }
  } catch (error) {
    document.getElementById('mensajeError').textContent = 'Error de conexión con el servidor.';
    console.error('Error al registrar:', error);
  }
});
